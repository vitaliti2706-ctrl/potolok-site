<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–∞—Ç—è–∂–Ω–∏—Ö —Å—Ç–µ–ª—å</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;background:#0f172a;color:#e2e8f0;margin:0}
    .wrap{max-width:980px;margin:32px auto;padding:16px}
    h1{margin:0 0 8px}
    .note{opacity:.85;margin:0 0 16px}
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:12px}
    .card{background:#111827;border:1px solid #1f2937;border-radius:14px;padding:14px}
    label{display:block;font-size:13px;margin-bottom:6px;opacity:.9}
    input,select{width:100%;box-sizing:border-box;background:#0b1220;border:1px solid #253046;border-radius:10px;padding:10px;color:#e5e7eb}
    input[type="number"]{appearance:textfield}
    .row{display:flex;gap:8px}
    .btn{cursor:pointer;border:0;border-radius:12px;padding:12px 16px;font-weight:600}
    .btn-primary{background:#16a34a;color:#fff}
    .btn-secondary{background:#334155;color:#e2e8f0}
    .sum{font-size:28px;font-weight:800;margin:6px 0}
    .muted{opacity:.8}
    .hr{height:1px;background:#22304b;margin:14px 0}
    .flex{display:flex;gap:10px;flex-wrap:wrap}
    .footer{margin-top:22px;padding:14px;background:#0b1220;border-radius:12px;border:1px solid #22304b}
    .inline{display:inline-block}
    /* Top nav (same style as index) */
    .topnav { background:#111827; border-bottom:1px solid #1f2937; }
    .topnav .inner { max-width:980px; margin:0 auto; padding:10px 16px; display:flex; gap:8px; flex-wrap:wrap; }
    .navlink { padding:10px 14px; border-radius:10px; text-decoration:none; color:#e2e8f0; background:#0b1220; border:1px solid #253046; }
    .navlink:hover { background:#0f172a; }
    .navlink.active { background:#16a34a; border-color:#16a34a; color:#fff; }
  </style>
</head>
<body>
  <!-- NAV DUPLICATE -->
  <div class="topnav">
    <div class="inner">
      <a class="navlink" href="/">–ì–æ–ª–æ–≤–Ω–∞</a>
      <a class="navlink" href="/gallery.html">–ì–∞–ª–µ—Ä–µ—è</a>
      <a class="navlink" href="/price.html">–ü—Ä–∞–π—Å</a>
      <a class="navlink active" href="/calculator.html">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä</a>
      <a class="navlink" href="/reviews.html">–í—ñ–¥–≥—É–∫–∏</a>
    </div>
  </div>

  <div class="wrap">
    <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–∞—Ä—Ç–æ—Å—Ç—ñ</h1>
    <p class="note">
      –ë–∞–∑–∞: <b>400 –≥—Ä–Ω/–º¬≤</b> (–ü–í–•-–±–∞–≥–µ—Ç) ‚Ä¢ –ê–ª—é–º—ñ–Ω—ñ—î–≤–∏–π –±–∞–≥–µ—Ç: <b>450 –≥—Ä–Ω/–º¬≤</b>.<br />
      –ü—Ä–∏ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—ñ –ø–æ–Ω–∞–¥ <b>50 –º¬≤</b> ‚Äî –∑–Ω–∏–∂–∫–∞ <b>10%</b>. –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è ‚Äî <b>5000 –≥—Ä–Ω</b>. –°–∞–Ω–≤—É–∑–ª–∏ —Ç–∞ –≤–∞–Ω–Ω—ñ –ø—Ä–∏ –æ–∫—Ä–µ–º–æ–º—É –º–æ–Ω—Ç–∞–∂—ñ —Ä–∞—Ö—É—é—Ç—å—Å—è –∑–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–º –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º.
    </p>

    <div class="grid">
      <div class="card">
        <h3>–ü–ª–æ—â–∞ —Ç–∞ —Ç–∏–ø</h3>
        <label>–ü–ª–æ—â–∞, –º¬≤</label>
        <input id="area" type="number" min="0" step="0.1" value="20" />
        <label style="margin-top:10px">–ü–µ—Ä–∏–º–µ—Ç—Ä, –º.–ø–æ–≥ (–¥–ª—è –¥–æ–≤—ñ–¥–∫–∏)</label>
        <input id="perimeter" type="number" min="0" step="0.1" value="18" />
        <label style="margin-top:10px">–¢–∏–ø –±–∞–≥–µ—Ç–∞</label>
        <select id="baseType">
          <option value="pvc">–ü–í–• (400 –≥—Ä–Ω/–º¬≤)</option>
          <option value="al">–ê–ª—é–º—ñ–Ω—ñ—î–≤–∏–π (450 –≥—Ä–Ω/–º¬≤)</option>
        </select>
      </div>

      <div class="card">
        <h3>–ü—Ä–æ—Ñ—ñ–ª—ñ</h3>
        <div class="row">
          <div style="flex:1">
            <label>–¢—ñ–Ω—å–æ–≤–∏–π –ø—Ä–æ—Ñ—ñ–ª—å, –º.–ø–æ–≥ (150 –≥—Ä–Ω/–º)</label>
            <input id="shadowLen" type="number" min="0" step="0.1" value="0" />
          </div>
          <div style="flex:1">
            <label>–ü–∞—Ä—è—â–∏–π –ø—Ä–æ—Ñ—ñ–ª—å, –º.–ø–æ–≥ (550 –≥—Ä–Ω/–º)</label>
            <input id="floatLen" type="number" min="0" step="0.1" value="0" />
          </div>
        </div>

        <label style="margin-top:10px">–ö–∞—Ä–Ω–∏–∑ –ø—ñ–¥ —à—Ç–æ—Ä—É, –º.–ø–æ–≥ (1000 –≥—Ä–Ω/–º)</label>
        <input id="corniceLen" type="number" min="0" step="0.1" value="0" />

        <label style="margin-top:10px">–î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞ –≤—Å—Ç–∞–≤–∫–∞, –º.–ø–æ–≥ (40 –≥—Ä–Ω/–º)</label>
        <input id="decorLen" type="number" min="0" step="0.1" value="0" />
      </div>

      <div class="card">
        <h3>–ï–ª–µ–∫—Ç—Ä–∏–∫–∞ / —Ç–æ—á–∫–∏</h3>
        <div class="row">
          <div style="flex:1">
            <label>–¢–æ—á–∫–æ–≤—ñ —Å–≤—ñ—Ç–∏–ª—å–Ω–∏–∫–∏, —à—Ç (150 –≥—Ä–Ω/—à—Ç)</label>
            <input id="spots" type="number" min="0" step="1" value="0" />
          </div>
          <div style="flex:1">
            <label>–õ—é—Å—Ç—Ä–∏, —à—Ç (400 –≥—Ä–Ω/—à—Ç)</label>
            <input id="chandeliers" type="number" min="0" step="1" value="0" />
          </div>
        </div>
        <div class="row" style="margin-top:10px">
          <div style="flex:1">
            <label>–ù–∞–∫–ª–∞–¥–Ω—ñ —Ç—Ä–µ–∫–∏, –º.–ø–æ–≥ (300 –≥—Ä–Ω/–º)</label>
            <input id="tracksLen" type="number" min="0" step="0.1" value="0" />
          </div>
          <div style="flex:1">
            <label>–ú–∞–≥–Ω—ñ—Ç–Ω–∞ –≤–∏—Ç—è–∂–∫–∞, —à—Ç (1000 –≥—Ä–Ω/—à—Ç)</label>
            <input id="vents" type="number" min="0" step="1" value="0" />
          </div>
        </div>

        <label style="margin-top:10px">–ü—Ä–æ–∫–ª–∞–¥–∫–∞ –∫–∞–±–µ–ª—é, –º.–ø–æ–≥ (30 –≥—Ä–Ω/–º)</label>
        <input id="cableLen" type="number" min="0" step="0.1" value="0" />
      </div>

      <div class="card">
        <h3>–ó–Ω–∏–∂–∫–∞ / –Ω–∞—Ü—ñ–Ω–∫–∞</h3>
        <label>–í–∫–∞–∂—ñ—Ç—å, % (–º—ñ–Ω—É—Å = –∑–Ω–∏–∂–∫–∞, –ø–ª—é—Å = –Ω–∞—Ü—ñ–Ω–∫–∞)</label>
        <input id="adjPct" type="number" step="1" value="0" />
        <p class="muted">–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –∑–Ω–∏–∂–∫–∞ 10%, —è–∫—â–æ –ø–ª–æ—â–∞ &gt; 50 –º¬≤.</p>

        <div class="hr"></div>
        <button id="calcBtn" class="btn btn-primary">–ü–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏</button>
        <button id="orderBtn" class="btn btn-secondary">–ó–∞–ª–∏—à–∏—Ç–∏ –∑–∞—è–≤–∫—É</button>
      </div>
    </div>

    <div class="card" style="margin-top:12px">
      <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç</h3>
      <div id="explain" class="muted"></div>
      <div class="sum" id="total">0 –≥—Ä–Ω</div>
      <div class="muted" id="minNote"></div>
    </div>

    <div class="footer">
  <div class="flex">
    <a class="btn btn-primary inline" href="tel:+380974546713">–ü–æ–¥–∑–≤–æ–Ω–∏—Ç–∏ –∑–∞—Ä–∞–∑</a>

    <!-- Telegram –≤ –≤–µ–±/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–µ–∑ –æ—à–∏–±–æ–∫ -->
    <a class="btn btn-secondary inline"
       href="https://t.me/PotolokKhBot"
       target="_blank" rel="noopener">
      –ó–∞–ª–∏—à–∏—Ç–∏ –∑–∞—è–≤–∫—É –≤ Telegram
    </a>

    <!-- Viber -->
    <a class="btn btn-secondary inline"
       href="viber://chat?number=%2B380974546713">
      Viber
    </a>

    <!-- WhatsApp -->
    <a class="btn btn-secondary inline"
       href="https://wa.me/380974546713"
       target="_blank" rel="noopener">
      WhatsApp
    </a>
  </div>

  <p class="muted" style="margin-top:8px">–ì—Ä–∞—Ñ—ñ–∫ —Ä–æ–±–æ—Ç–∏: –ü–Ω‚Äì–°–±, 09:00‚Äì18:00.</p>
</div>

  <script>
    function num(v){ var n = +v; return isFinite(n) ? n : 0; }
    function UAH(n){ return new Intl.NumberFormat('uk-UA').format(Math.round(n)); }
    function $(id){ return document.getElementById(id); }

    function compute(){
      var area     = num($('area').value);
      var baseType = $('baseType').value;

      var basePrice = (baseType === 'al') ? 450 : 400;

      var shadow   = num($('shadowLen').value)  * 150;
      var floating = num($('floatLen').value)   * 550;
      var cornice  = num($('corniceLen').value) * 1000;
      var decor    = num($('decorLen').value)   * 40;

      var spots    = num($('spots').value)       * 150;
      var chand    = num($('chandeliers').value) * 400;
      var tracks   = num($('tracksLen').value)   * 300;
      var vents    = num($('vents').value)       * 1000;
      var cable    = num($('cableLen').value)    * 30;

      var base     = area * basePrice;
      var byMeter  = shadow + floating + cornice + decor + tracks + cable;
      var byPieces = spots + chand + vents;

      var subtotal = base + byMeter + byPieces;

      var adjPct = num($('adjPct').value);
      if (adjPct !== 0) subtotal = subtotal * (100 + adjPct) / 100;

      var autoDiscApplied = false;
      if (area > 50){ subtotal = subtotal * 0.9; autoDiscApplied = true; }

      var MIN = 5000;
      var total = Math.max(MIN, Math.round(subtotal));

      var parts = [
        '–ë–∞–∑–∞: ' + area + ' –º¬≤ √ó ' + basePrice + ' = ' + UAH(base) + ' –≥—Ä–Ω',
        '–î–æ–≤–∂–∏–Ω–∞/–º.–ø–æ–≥: ' + UAH(byMeter) + ' –≥—Ä–Ω',
        '–ü–æ—à—Ç—É—á–Ω–æ: ' + UAH(byPieces) + ' –≥—Ä–Ω'
      ];
      if (adjPct){ parts.push((adjPct > 0 ? '–ù–∞—Ü—ñ–Ω–∫–∞ ' : '–ó–Ω–∏–∂–∫–∞ ') + adjPct + '% –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–∞'); }
      if (autoDiscApplied){ parts.push('–ê–≤—Ç–æ-–∑–Ω–∏–∂–∫–∞ 10% (–ø–ª–æ—â–∞ > 50 –º¬≤)'); }

      $('explain').innerText = parts.join(' ¬∑ ');
      $('total').innerText   = UAH(total) + ' –≥—Ä–Ω';
      $('minNote').innerText = (total === MIN)
        ? '–ó–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–æ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è 5000 –≥—Ä–Ω. –°–∞–Ω–≤—É–∑–ª–∏ —Ç–∞ –≤–∞–Ω–Ω—ñ –ø—Ä–∏ –æ–∫—Ä–µ–º–æ–º—É –º–æ–Ω—Ç–∞–∂—ñ —Ä–∞—Ö—É—é—Ç—å—Å—è –∑–∞ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–º –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è–º.'
        : '';

      return { total: total, area: area, basePrice: basePrice };
    }

    async function openOrder(){
      var data  = compute();
      var name  = prompt('–í–∫–∞–∂—ñ—Ç—å –≤–∞—à–µ —ñ–º\'—è:');
      if (!name) return;
      var phone = prompt('–í–∞—à —Ç–µ–ª–µ—Ñ–æ–Ω (+380‚Ä¶):');
      if (!phone) return;
      var note  = prompt('–ö–æ–º–µ–Ω—Ç–∞—Ä (–Ω–µ–æ–±–æ–≤\'—è–∑–∫–æ–≤–æ):') || '';

      try{
        var payload = { name: name, phone: phone, message: '–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –∑ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞. –°—É–º–∞: ' + data.total + ' –≥—Ä–Ω. ' + note, source: location.pathname };
        var resp = await fetch('/api/telegram-submit', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
        if (!resp.ok){ var t = await resp.text(); throw new Error(t || ('HTTP ' + resp.status)); }
        alert('‚úÖ –î—è–∫—É—î–º–æ!\n–í–∞—à–∞ –∑–∞—è–≤–∫–∞ —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞ üì®\n–ú–∏ –∑–≤‚Äô—è–∂–µ–º–æ—Å—è –∑ –≤–∞–º–∏ –ø—Ä–æ—Ç—è–≥–æ–º 10‚Äì15 —Ö–≤–∏–ª–∏–Ω ‚è≥');
      }catch(e){
        console.error(e);
        alert('–ù–µ –≤–¥–∞–ª–æ—Å—å –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏. –°–ø—Ä–æ–±—É–π—Ç–µ —â–µ —Ä–∞–∑ –∞–±–æ –Ω–∞–ø–∏—à—ñ—Ç—å —É Telegram.');
      }
    }

    function bindLive(){
      compute();
      $('calcBtn').addEventListener('click', compute);
      $('orderBtn').addEventListener('click', openOrder);
      var nodes = document.querySelectorAll('input,select');
      for (var i=0;i<nodes.length;i++){
        nodes[i].addEventListener('input', compute);
        nodes[i].addEventListener('change', compute);
      }
    }
    if (document.readyState === 'loading'){ document.addEventListener('DOMContentLoaded', bindLive); }
    else { bindLive(); }
  </script>
</body>
</html>
